{% extends "irrigation/master.html" %}



{%block menuArduino%}active{% endblock%}

{% block content %}
	

	<div class="row">
			<div class="col-lg-12">
			<table class="table" id="moistureTable">
				<thead>
				<tr> <th>Arduinos</th><th> Status</th></tr>
				</thead>
				<tbody>
                  
				{% if arduinoList %}
					{%for arduino in arduinoList%}
						<tr>
							<td>Arduino UNO ReV3</td>
							<td>
                                {% ifequal arduino.status 1 %}
                                    <button class="btn btn-danger">Desligar</button>
                                {%else%}
                                    <button class="btn btn-success">Ligar</button>
                                {%endifequal%}
                            </td>
						
						</tr>
					{% endfor %}
				{%endif%}
				</tbody>
			</table>
		</div>
	</div>


{% endblock%}

{% block scripts%}
<script type="text/javascript">
	var json;
	
	var lastID={{moistureList.0.id}}
		$(document).ready(function(){
			getMoisture();
				//setInterval(getMoisture,5000);
			
		});
		
		function getMoisture(){
			
					$.ajax({
							type:'POST',
							url:'getMoisture/',
							data:{csrfmiddlewaretoken:'{{csrf_token}}',lastID:1}
							
					}).done(function(data){
							if(data!=""){
									 json=data;
									 $.each(json,function(idx,obj){
										 $('#moistureTable tbody').prepend("<tr><td>"+obj.fields.moisture+"</td><td>"+obj.fields.date+"</td></tr>");
										
										 });
									
							}
					});
	}
</script>

{%endblock %}
